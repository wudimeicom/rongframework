<!DOCTYPE html>
<html>
    <head>
        <title>路由</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <link href="style.css" rel="stylesheet" type="text/css" />        <meta name="keywords" content="路由,Rong Framework" />
        <meta name="description" content="路由,Rong Framework" />
    </head>
    <body>
        <div class="Page">
            <div class="top">
    <div class="rf">Rong Framework</div>
</div>            <div class="content"> 
                <div>
                    <a href="index.html">目录</a>
                </div>
                
                 <div class="ctrl">
                    上一页:
                                        <a href="Rong.Controller.Request.html"> 去除magic_quotes</a>
                    
                    &nbsp;
                    <a href="index.html">目录</a>
                    &nbsp;
                    下一页 :
                                        <a href="DevelopmentToolKit.html">Dev</a>
                                    </div> 
                <h3>路由</h3>
                
<h1><strong>路由</strong></h1>

<p><span class="title1">一、示例</span><br />
先让我们看完一个示例后再做介绍。</p>

<p>文件：/index.php</p>

<p><div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*<br />&nbsp;*&nbsp;Rong&nbsp;PHP&nbsp;Framework<br />&nbsp;*&nbsp;author:Yang&nbsp;Qing-rong<br />&nbsp;*&nbsp;Email&nbsp;:&nbsp;yaqy@qq.com&nbsp;yangqingrong@gmail.com<br />&nbsp;*&nbsp;blog&nbsp;&nbsp;:&nbsp;http://hi.baidu.com/tangtou<br />&nbsp;*&nbsp;This&nbsp;is&nbsp;a&nbsp;free&nbsp;software&nbsp;under&nbsp;the&nbsp;GNU&nbsp;Licence.<br />&nbsp;*/&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #0000BB">ini_set</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">"display_errors"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"1"&nbsp;</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">define</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">"ROOT"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">dirname</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">__FILE__&nbsp;</span><span style="color: #007700">)&nbsp;);<br /></span><span style="color: #0000BB">set_include_path</span><span style="color: #007700">(&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"."&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">PATH_SEPARATOR&nbsp;</span><span style="color: #007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//ROOT."/lib".<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"d:/www/wudimei/wudimei.com/lib"&nbsp;</span><span style="color: #007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">PATH_SEPARATOR&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">get_include_path</span><span style="color: #007700">()&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />require_once&nbsp;</span><span style="color: #DD0000">'Rong/Controller/Route.php'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$route&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Rong_Controller_Route</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">$route</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">"product-:num.html"</span><span style="color: #007700">,</span><span style="color: #DD0000">"Index/router/$1"&nbsp;</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$route</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(</span><span style="color: #DD0000">"user/:num/:word/:any.html"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Index/user_router/$1/$2/$3"&nbsp;</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$route</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'article/([0-9]{3,4})/([a-zA-Z]{1,3})\.html\?id=:num'&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Index/article_router/$1/$2/$3'&nbsp;</span><span style="color: #007700">);<br /><br />&nbsp;<br /><br /><br />require_once&nbsp;</span><span style="color: #DD0000">'Rong/Controller/Engine.php'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$engine&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Rong_Controller_Engine</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$engine</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setRoute</span><span style="color: #007700">(</span><span style="color: #0000BB">$route</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$engine</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setControllersDirectory</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">ROOT&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"/application/controllers"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$engine</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">start</span><span style="color: #007700">();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div></p>

<p>实现<strong>路由</strong>的方法是在入口页index.php的 Rong_Controller_Guide()的实例调用 start()方法之前，实例化 Rong_Controller_Route()对象。 并调用该对象的 add( 当前uri, 转发到uri );以添加一个<strong>路由</strong>，<strong>路由</strong>采用正则替换。</p>

<div class="title1">关键字</div>

<p><b>:num</b> 代表一个数字。<br />
<b>:word</b> 代表一个word<br />
<b>:any</b> 代表任意字符<br />
先看如下代码：</p>

<p><div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$route</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">"article/([0-9]{3,4})/([0-9]{1,2}).html"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"index/uri/$1/$2"&nbsp;</span><span style="color: #007700">);</span></span></code></div></p>

<p>然后访问：/index.php/article/323/32.html<br />
你会发现你的网址被转发到 /index/uri/323/32 这里来了。这样就实现了<strong>伪静态</strong>。<br />
再试试带有?查询字符的<strong>路由</strong>:<br />
/index.php/article/323/abc.html?id=333<br />
<div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$route</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">add</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">'article/([0-9]{3,4})/([a-zA-Z]{1,3})\.html\?id=:num'&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Index/article_router/$1/$2/$3'&nbsp;</span><span style="color: #007700">);</span></span></code></div></p>



                <div class="ctrl">
                    上一页:
                                        <a href="Rong.Controller.Request.html"> 去除magic_quotes</a>
                    
                    &nbsp;
                    <a href="index.html">目录</a>
                    &nbsp;
                    下一页 :
                                        <a href="DevelopmentToolKit.html">Dev</a>
                                    </div> 
            </div>
            <div class="bottom">
 要获取最新的Rong Framework,请访问<a href="http://rong.wudimei.com" target="_balnk">http://rong.wudimei.com</a></div>  
        </div>
    </body>
</html>