<!DOCTYPE html>
<html>
    <head>
        <title>class Rong_Db,connect to mysql</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <link href="style.css" rel="stylesheet" type="text/css" />        <meta name="keywords" content="class Rong_Db,connect to mysql,Rong Framework" />
        <meta name="description" content="class Rong_Db,connect to mysql,Rong Framework" />
    </head>
    <body>
        <div class="Page">
            <div class="top">
    <div class="rf">Rong Framework</div>
</div>            <div class="content"> 
                <div>
                    <a href="index.html">Table Of Contents</a>
                </div>
                
                 <div class="ctrl">
                    Prev Page:
                                        <a href="Rong.Db_intro.html"> database introduction</a>
                    
                    &nbsp;
                    <a href="index.html">Table Of Contents</a>
                    &nbsp;
                    Next Page :
                                        <a href="Rong.Db.Driver.Sqlite.php">Rong_Db connect to sqlite</a>
                                    </div> 
                <h3>class Rong_Db,connect to mysql</h3>
                In this article,i use "Rong Framework" as a library.<br><br>1.assamed you have a Mysql server,host name is:"localhost",username is:"root",password is "123456",database name is:"rong_db".<br>please create a table named "w_table" in database "rong_db":<br><div class="code"  ><pre>CREATE TABLE IF NOT EXISTS `w_article` (
  `id` int(10) NOT NULL auto_increment,
  `title` varchar(255) NOT NULL default ' ',
  `content` text NOT NULL,
  `add_time` timestamp NOT NULL default CURRENT_TIMESTAMP,
  PRIMARY KEY  (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=41 ;</pre></div><br>assamed your file structure in the website like this:<br>/lib/Rong&nbsp;&nbsp;&nbsp; #rong framework<br>/test/db.php #the file i talked in this article,can be download from the released zip file.<br><br>2.let us add Rong Framework into include path at first:<br><div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$PathToRongFramework&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">dirname</span><span style="color: #007700">(</span><span style="color: #0000BB">__FILE__</span><span style="color: #007700">).</span><span style="color: #DD0000">"/../../lib"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">set_include_path</span><span style="color: #007700">(&nbsp;&nbsp;</span><span style="color: #DD0000">"."&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">PATH_SEPARATOR&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$PathToRongFramework&nbsp;</span><span style="color: #007700">.&nbsp;&nbsp;</span><span style="color: #0000BB">PATH_SEPARATOR&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">get_include_path</span><span style="color: #007700">()&nbsp;);</span></span></code></div><br>3.include class Rong_Db and create a instance:<br><div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//require&nbsp;the&nbsp;Rong_Db&nbsp;from&nbsp;the&nbsp;include&nbsp;path<br /><br /></span><span style="color: #007700">require_once&nbsp;</span><span style="color: #DD0000">'Rong/Db.php'</span><span style="color: #007700">;<br /><br />echo&nbsp;</span><span style="color: #DD0000">"&lt;h1&gt;test&nbsp;database&nbsp;mysqli&nbsp;(测试mysqli)&lt;/h1&gt;"</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//$GLOBALS["debug"]&nbsp;=1;//debug&nbsp;the&nbsp;sql&nbsp;if&nbsp;is&nbsp;set<br /><br /></span><span style="color: #0000BB">$db&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Rong_Db</span><span style="color: #007700">::</span><span style="color: #0000BB">factory</span><span style="color: #007700">(</span><span style="color: #DD0000">"Mysql"</span><span style="color: #007700">,&nbsp;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"host"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">,&nbsp;</span><span style="color: #FF8000">//db&nbsp;host&nbsp;name<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"username"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"root"</span><span style="color: #007700">,&nbsp;&nbsp;</span><span style="color: #FF8000">//db&nbsp;username<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"password"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"123456"</span><span style="color: #007700">,&nbsp;</span><span style="color: #FF8000">//db&nbsp;password<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"dbname"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"rong_db"</span><span style="color: #007700">,&nbsp;</span><span style="color: #FF8000">//mysql&nbsp;database&nbsp;name<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"charset"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"utf8"&nbsp;</span><span style="color: #007700">,</span><span style="color: #FF8000">//db&nbsp;default&nbsp;charset<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"table_prefix"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"w_"&nbsp;</span><span style="color: #FF8000">//table&nbsp;prefix<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />echo&nbsp;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">error</span><span style="color: #007700">();</span></span></code></div><br>4.now we can create a record in the database.<br><div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />&nbsp;<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"1.insert&nbsp;data&nbsp;into&nbsp;table&nbsp;`w_article`&nbsp;...&nbsp;(向数据库插入数据,执行sql语解码器)&lt;br&nbsp;/&gt;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">"insert&nbsp;into&nbsp;w_article(&nbsp;title&nbsp;,content)&nbsp;values('hello','world'&nbsp;)"</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">"Last&nbsp;Insert&nbsp;id:"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">insertId</span><span style="color: #007700">()&nbsp;.</span><span style="color: #DD0000">"&lt;br&nbsp;/&gt;"</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">error</span><span style="color: #007700">().</span><span style="color: #DD0000">"&lt;br&nbsp;/&gt;"</span><span style="color: #007700">;</span></span></code></div><br>5.let us create a record using array mode(fieldname=&gt;value)<br><div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'2.insert&nbsp;array&nbsp;to&nbsp;database&nbsp;以数组的方式插入到数据库中。&nbsp;&lt;br&nbsp;/&gt;&nbsp;'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$lastInsertId&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">insert</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">"w_article"&nbsp;</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"title"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"my&nbsp;god"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"content"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"what&nbsp;a&nbsp;pitty"&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">)<br />);<br />echo&nbsp;</span><span style="color: #DD0000">'last&nbsp;insert&nbsp;id(最后插入编号):'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$lastInsertId&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'&lt;br&nbsp;/&gt;'</span><span style="color: #007700">;</span></span></code></div><br>6.update data<br><div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'3.update&nbsp;database.&nbsp;以数组的方式(字段名=&gt;字段值)更新数据&lt;br&nbsp;/&gt;'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$affectedRows&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">update</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">"w_article"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"content"</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"new&nbsp;content"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">),<br />&nbsp;&nbsp;</span><span style="color: #DD0000">"id=1"&nbsp;</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">'affected&nbsp;rows:'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$affectedRows&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'&lt;br&nbsp;/&gt;'</span><span style="color: #007700">;</span></span></code></div><br>7.delete data:<br><div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'4.delete&nbsp;data.(删除数据)&lt;br&nbsp;/&gt;'</span><span style="color: #007700">;&nbsp;<br /></span><span style="color: #0000BB">$affectedRows&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">delete</span><span style="color: #007700">(</span><span style="color: #DD0000">"w_article"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"id=1"</span><span style="color: #007700">);</span><span style="color: #FF8000">//parameter&nbsp;table&nbsp;name&nbsp;,condition&nbsp;sql&nbsp;statement<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'affected&nbsp;rows:'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$affectedRows&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'&lt;br&nbsp;/&gt;'</span><span style="color: #007700">;</span></span></code></div><br>8.fetch all data from the table w_article as an array.<br><div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"5.show&nbsp;all&nbsp;data&nbsp;from&nbsp;w_article&nbsp;table:(打印出数据库中的所有数据)&lt;br&nbsp;/&gt;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$rows&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">(</span><span style="color: #DD0000">"select&nbsp;*&nbsp;from&nbsp;w_article"</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">'&lt;pre&gt;'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$rows</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">'&lt;/pre&gt;'</span><span style="color: #007700">;</span></span></code></div><br>9.excute multiple sql query:<br><div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"6.Querying&nbsp;muliple&nbsp;sql.&nbsp;(查询多条sql语句)&lt;br&nbsp;/&gt;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$r2&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">call</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">"select&nbsp;*&nbsp;from&nbsp;w_article;select&nbsp;now();select&nbsp;*&nbsp;from&nbsp;w_article;select&nbsp;now();"&nbsp;</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">'&lt;pre&gt;'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$r2&nbsp;</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">'&lt;/pre&gt;'</span><span style="color: #007700">;</span></span></code></div><br>10.Notice: methods such as delete(),update() and insert()in class Rong_Db,the first parammeter is the FULL table name include the "table_prefix".they are different from class Rong_Db_Model.<br><br><br>





                <div class="ctrl">
                    Prev Page:
                                        <a href="Rong.Db_intro.html"> database introduction</a>
                    
                    &nbsp;
                    <a href="index.html">Table Of Contents</a>
                    &nbsp;
                    Next Page :
                                        <a href="Rong.Db.Driver.Sqlite.php">Rong_Db connect to sqlite</a>
                                    </div> 
            </div>
            <div class="bottom">
 To get the last version of Rong Framework.please vist <a href="http://rong.wudimei.com" target="_balnk">http://rong.wudimei.com</a></div>  
        </div>
    </body>
</html>