<!DOCTYPE html>
<html>
    <head>
        <title>Cache</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
 <link href="style.css" rel="stylesheet" type="text/css" />        <meta name="keywords" content="Cache,Rong Framework" />
        <meta name="description" content="Cache,Rong Framework" />
    </head>
    <body>
        <div class="Page">
            <div class="top">
    <div class="rf">Rong Framework</div>
</div>            <div class="content"> 
                <div>
                    <a href="index.html">Table Of Contents</a>
                </div>
                
                 <div class="ctrl">
                    Prev Page:
                                        <a href="Rong.View.Wudimei.comment.html"> comment</a>
                    
                    &nbsp;
                    <a href="index.html">Table Of Contents</a>
                    &nbsp;
                    Next Page :
                                        <a href="Rong.Acl.html">Acl</a>
                                    </div> 
                <h3>Cache</h3>
                <h1>Cache</h1>

<p><span class="title1">1.instance a cache object</span></p>

 
<div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">require_once&nbsp;</span><span style="color: #DD0000">'Rong/Cache.php'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$config&nbsp;</span><span style="color: #007700">=&nbsp;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"cache_dir"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">ROOT</span><span style="color: #007700">.</span><span style="color: #DD0000">"/temp/cache"<br /></span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$cache&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Rong_Cache</span><span style="color: #007700">::</span><span style="color: #0000BB">factory</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">"File"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$config&nbsp;</span><span style="color: #007700">);</span></span></code></div>
 

<p><b>Rong_Cache::factory( $adapter , $config );</b><br>
$adapter :cache adapter , eg "File"<br>
$config : array , the setting of the cache<br>
a)for file cache , we need set the "cache_dir" to contain the file caches.<br>
<span class="title1">2. save the data to the cache</span></p>

 
<div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$cache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">"user_137"&nbsp;</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(</span><span style="color: #DD0000">"id"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">137&nbsp;</span><span style="color: #007700">,</span><span style="color: #DD0000">"name"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">"yang&nbsp;qing&nbsp;rong&nbsp;"&nbsp;</span><span style="color: #007700">),&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">200000&nbsp;</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(</span><span style="color: #DD0000">"user"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"137"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"name"</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</span></span></code></div>
 

<p><b>Rong_Cache::set( $cache_name , $value , $seconds , $tags = array() );</b><br>
$cache_name : the name of a cache<br>
$value : mixed valuen<br>
$seconds: cache life time.<br>
$tags : tag array,it contains some key words , for delete or update.<br>
<span class="title1">3. get the cache we saved</span></p>

 
<div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$val&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$cache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(&nbsp;</span><span style="color: #DD0000">"user_137"&nbsp;</span><span style="color: #007700">);</span></span></code></div>
 
<p><b>Rong_Cache::get( $cache_name );</b><br>
the cache name we save before.<br>
@return: cache<br>
<span class="title1">4. update cache</span><br>
<b>Rong_Cache::update( $key , $value , $tag = array() ); </b><br>
$key : cache name<br>
$value: mixed , new cache value<br>
empty ,we don't update the old tag, or update the tage provider by the new array $tag.'<br>
<b>Rong_Cache::$cache-&gt;deleteOld( ); </b><br>
delete all expired cache<br>
<b>Rong_Cache::delete( $key );</b><br>
the cache by cache name<br>
<b>Rong_Cache::deleteByTag( $tag = array() , $type )</b><br>
$tag :delete cache by tag array<br>
$type: can be these values:<br>
"all": if all tag match the cache's tag,the cachewill be delete.<br>
"any":if one tage match the cache's tage, the cachewill be delete.</p><p><br></p><p>A Sample:<br>Filename: /test/cache/cache_file.php<div class="code"  ><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/**<br />&nbsp;*&nbsp;file&nbsp;encoding&nbsp;utf-8<br />&nbsp;*&nbsp;文件字符编码utf-8<br />&nbsp;*/<br /></span><span style="color: #0000BB">$PathToRongFramework&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">dirname</span><span style="color: #007700">(</span><span style="color: #0000BB">__FILE__</span><span style="color: #007700">).</span><span style="color: #DD0000">"/../../lib"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">set_include_path</span><span style="color: #007700">(&nbsp;&nbsp;</span><span style="color: #DD0000">"."&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">PATH_SEPARATOR&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$PathToRongFramework&nbsp;</span><span style="color: #007700">.&nbsp;&nbsp;</span><span style="color: #0000BB">PATH_SEPARATOR&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">get_include_path</span><span style="color: #007700">()&nbsp;);<br /><br /></span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Content-Type:&nbsp;text/html;&nbsp;charset=utf-8"</span><span style="color: #007700">);<br /><br />require_once&nbsp;</span><span style="color: #DD0000">'Rong/Cache.php'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">date_default_timezone_set</span><span style="color: #007700">(</span><span style="color: #DD0000">"Asia/Shanghai"</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #DD0000">"&lt;h3&gt;Demo&nbsp;cache&lt;/h3&gt;"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$cache&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Rong_Cache</span><span style="color: #007700">::</span><span style="color: #0000BB">factory</span><span style="color: #007700">(</span><span style="color: #DD0000">"File"</span><span style="color: #007700">,&nbsp;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"cache_dir"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">dirname</span><span style="color: #007700">(</span><span style="color: #0000BB">__FILE__</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"/data/file_cache"<br /></span><span style="color: #007700">));<br /><br /><br /><br />echo&nbsp;</span><span style="color: #DD0000">'1.save&nbsp;data&nbsp;to&nbsp;cache&nbsp;as&nbsp;the&nbsp;name&nbsp;of&nbsp;"color"&nbsp;,&nbsp;with&nbsp;tags&nbsp;"color"&nbsp;and&nbsp;"basic_color"(保存数据“green","orange"到名为"color"的缓存，标签是："color"和"basic_color")&nbsp;&lt;br&nbsp;/&gt;'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$cache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set</span><span style="color: #007700">(</span><span style="color: #DD0000">"color"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">"green"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"orange"</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">30</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">"color"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"basic_color"</span><span style="color: #007700">));<br /><br /><br /><br />echo&nbsp;</span><span style="color: #DD0000">'2.get&nbsp;the&nbsp;cache&nbsp;by&nbsp;the&nbsp;name&nbsp;"color"&nbsp;&nbsp;以"color"为缓存名取得缓存&lt;br&nbsp;/&gt;'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$cache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #DD0000">"color"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$val</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #0000BB">$cache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">update</span><span style="color: #007700">(</span><span style="color: #DD0000">"color"</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">"blue"</span><span style="color: #007700">),&nbsp;array(</span><span style="color: #DD0000">"new_tag"</span><span style="color: #007700">));<br />echo&nbsp;</span><span style="color: #DD0000">'&lt;br&nbsp;/&gt;&nbsp;3.update&nbsp;the&nbsp;cache&nbsp;with&nbsp;new&nbsp;value&nbsp;and&nbsp;new&nbsp;tag:更新缓存的值和标签&lt;br&nbsp;/&gt;'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$cache</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">get</span><span style="color: #007700">(</span><span style="color: #DD0000">"color"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$val</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #FF8000">/*<br />echo&nbsp;'&lt;br&nbsp;/&gt;delete&nbsp;tag&nbsp;"color"&nbsp;and&nbsp;then&nbsp;output&nbsp;it\'s&nbsp;value:&nbsp;删除缓存后输出结果&lt;br&nbsp;/&gt;';<br />$val&nbsp;=&nbsp;$cache-&gt;delete("color");<br />$val&nbsp;=&nbsp;$cache-&gt;get("color");<br />var_dump($val);<br />*/<br /><br />/*<br />echo&nbsp;'&lt;br&nbsp;/&gt;delte&nbsp;old&nbsp;caches:删除过去的缓存&lt;br&nbsp;/&gt;';<br />$cache-&gt;deleteOld();<br />*/<br /><br />/*<br />echo&nbsp;'&lt;br&nbsp;/&gt;delete&nbsp;by&nbsp;tag&nbsp;name,it&nbsp;maths&nbsp;any&nbsp;tag&nbsp;name&nbsp;of&nbsp;"color"&nbsp;or&nbsp;"basic_color":按标签名删除缓存&lt;br&nbsp;/&gt;';<br />$cache-&gt;deleteByTag(array("color",&nbsp;"new_tag"),&nbsp;"any");<br />*/<br /><br /><br /><br /></span></span></code></div><br></p><p></p>






                <div class="ctrl">
                    Prev Page:
                                        <a href="Rong.View.Wudimei.comment.html"> comment</a>
                    
                    &nbsp;
                    <a href="index.html">Table Of Contents</a>
                    &nbsp;
                    Next Page :
                                        <a href="Rong.Acl.html">Acl</a>
                                    </div> 
            </div>
            <div class="bottom">
 To get the last version of Rong Framework.please vist <a href="http://rong.wudimei.com" target="_balnk">http://rong.wudimei.com</a></div>  
        </div>
    </body>
</html>